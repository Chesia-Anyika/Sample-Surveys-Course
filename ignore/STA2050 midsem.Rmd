---
title: "STA2050 - Midsem"
author: "Chesia Anyika"
date: "2024-02-21"
output:
  word_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Libraries

```{r}
#for combination computation
library(gtools)

#for golfsrs.dat
library(SDAResources)

#for histogram plotting
library(tidyverse)
library(sampling)
library(survey)
```

# Question 1

### Part a)

For the survey given below describe the target population, sampling frame, sampling unit, and observation unit. Discuss any possible sources of selection bias or inaccuracy of responses **(4 marks)**

*A survey is conducted to find the average weight of cows in a region. A list of all farms is available for the region, and 50 farms are selected at random. Then the weight of each cow at the 50 selected farms is recorded.*

The **Target Population** is all cows in that specific region.

The **Sampling Frame** is the list of all the farms in the specific region.

The **Sampling Unit** is one farm.

The **Observation Unit** is one cow.

**Bias**

There is no discernible reason for bias in the information given above.

### Part b)

(i). List all possible simple random samples of size $n = 2$ that can be selected from the population $[0, 1, 2, 3, 4]$. (**3marks)**

To compute this I used the `combination()` function from the `gtools` library as follows:

```{r}
#define parameters
v1 <- c(0,1,2,3,4)
N = length(v1)
n = 2

#get the samples of n=2 of v1 #library(gtools)
samples1 <- combinations(n = N, r = n, v = v1, repeats.allowed = FALSE)

#View the samples
samples1

```

(ii) Calculate $\sigma^2$ for the population and $V\bar y$ for the sample **(5marks)**

First I computed the population variance, using the `var()` function on the population vector

```{r}
Var.pop <- var(v1)
cat('Population variance: ', Var.pop)
```

I then obtained the mean estimates of the samples as per the formula

$$
V(\bar y) = (1 - \frac{n}{N}) \times \frac{\sigma^2}{n}
$$

```{r}
var.est = (1 - n/N) * Var.pop/n
cat('variance estimate:', var.est)
```

### Part c)

The Internet site www.golfcourse.com listed 14,938 golf courses by state. It gave a variety of information about each course, including greens fees, course rating, par for the course, and facilities. Data from an SRS of 120 of the golf courses is in file golfsrs.dat.

**i.** Display the data in a histogram for the weekday greens fees for nine holes of golf. How would you describe the shape of the data? **(3marks)**

First I imported the data into r

```{r}
data("golfsrs")

names(golfsrs)
```

The variable associated with **weekday greens fees for nine holes** is `wkday9`. First I checked the datatype of the variable.

```{r}
class(golfsrs$wkday9)
```

I then plotted the histogram using `geom_histogram()` from the `ggplot2` library.

```{r}
#plot histogram #library(tidyverse)
ggplot(golfsrs, aes(x = wkday9)) +
  geom_histogram(fill = "purple", color = "black", alpha = 0.7) +
  labs(x = "Weekday Greens Fees (9 holes)", y = "Frequency") +
  ggtitle("Histogram of Weekday Greens Fees (9 holes)")
```

The histogram is right skewed, implying that the mode of the variable is less than the median and mean. Thus weekday greens fees for 9 holes tend to be on the lower end.

**ii.**Find the average weekday greens fee to play nine holes of golf, and give the SE for your estimate. **(5marks)**

# Question 2

### Part a)

Suppose that a city has 90,000 dwelling units, of which 35,000 are houses, 45,000 are apartments, and 10,000 are condominiums. You believe that the mean electricity usage is about twice as much for houses as for apartments or condominiums, and that the standard deviation is proportional to the mean so that S1 = 2S2 = 2S3.

i.  How would you allocate a stratified sample of 900 observations if you wanted to estimate the mean electricity consumption for all households in the city? **(4 marks)**

To do this i created a data-frame with all the observations, and calculated the allocations in the column `nh`.

```{r}
# define parameters
stratum <- c("Houses", "Apartments", "Condos")
Nh <- c(35000, 45000, 10000) 
Rh <- c(2,1,1)  

#NhRh for each stratum
NhRh <-Nh*Rh

#nh for each stratum
nh <- round(900*NhRh/sum(NhRh))

#create sums vector
Sum <- c('Sum', sum(Nh), sum(Rh), sum(NhRh), sum(nh))

#create a data frame
dwelling.df <- data.frame(Stratum=stratum,Nh=Nh,Rh=Rh,NhRh=NhRh,nh=nh)

#row bind the sums
dwelling.df <- rbind(dwelling.df, Sum)

#Print the data frame
dwelling.df

```

The nh column represents the allocations, which are:

$$
Houses = 504\\Apartments = 324\\Condos = 72
$$

ii. Explain an advantage of using a stratified sample rather than a simple random sample: **(2 marks)**

> Ensuring diversity of your sample : Stratified random sampling allows one to be protected from the possibility of obtaining a really bad sample, by ensuring each stratum is represented in the sample.

### Part b)

The data below  are the number of pepper standards for the randomly selected villages in each of the three strata of Karen Zone

| **Stratum** | Number of villages selected from the stratum       | Total number of villages in the stratum |
|-------------|----------------------------------------------------|-----------------------------------------|
| **1**       | 41, 116, 19, 15, 144, 159, 212, 57, 28, 76, 119    | $N_1 = 441$                             |
| **2**       | 39, 70, 38, 37, 161, 38, 27, 119, 36, 128, 30, 208 | $N_2 = 405$                             |
| **3**       | 252, 386, 192, 296, 115, 159, 120                  | $N_3 = 103$                             |

Estimate the total number of pepper standards along with its standard error in Karen Zone. **(10 marks)**

First I created vectors with the above information

```{r}
#create vectors of numbers of villages sampled
v1 <- c(41, 116, 19, 15, 144, 159, 212, 57, 28, 76, 119)
v2 <- c(39, 70, 38, 37, 161, 38, 27, 119, 36, 128, 30, 208)
v3 <- c(252, 386, 192, 296, 115, 159, 120)

#check lengths
l1 =length(v1)
l2 = length(v2)
l3 = length(v3)

l1
l2
l3
```

Using the lengths above, I created a stratum variable and created a dataframe with this and the vectors

```{r}
#define variables
stratum <- c(rep(1, l1), rep(2, l2), rep(3, l3))
Villages <- c(v1, v2, v3)

#create dataframe
df <- data.frame(stratum, Villages)

#view dataframe
df
```

To get the total number of pepper standards, we use the formula

$$
T = N(\bar y_{st}) = [N_1\bar y_1 + N_2\bar y_2 +...+ N_L\bar y_L] = \sum_{i = 1}^LN_i\bar y_i
$$

```{r}
#get sample means 
y1 <- sum(v1)/l1
y2 <- sum(v2)/l2
y3 <- sum(v3)/l3

#define parameter vectors
Ni <- c(441, 405, 103)
yi <- c(y1, y2, y3)

#run formula
T.est <- sum(Ni*yi)

#estimator of population total
cat('Total Estimate:', T.est)
```

### Part c)

a)  John is looking at the beats per minute of tracks in his music player. He has 1200 tracks. He decides to take a systematic sample of 25% of his tracks. Determine the tracks that should be chosen. Using linear systematic sampling with program R  to select n  **(4 marks)**
